/**
 * jquery-skeduler - This is jQuery plugin which provider you simple scheduler with some items on OX and 24-hours timeline on OY.
 * @date Tue Aug 01 2017 14:59:01 GMT+1000 (Russia TZ 9 Standard Time)
 * @version v0.2.0-beta.0
 * @link 
 * @license ISC
 */
!function e(t,s,i){function n(r,o){if(!s[r]){if(!t[r]){var l="function"==typeof require&&require;if(!o&&l)return l(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=s[r]={exports:{}};t[r][0].call(u.exports,function(e){var s=t[r][1][e];return n(s?s:e)},u,u.exports,e,t,s,i)}return s[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}({1:[function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var n=e("./skeduler"),a=i(n);$.fn.skeduler=function(e){var t=$(this),s=new a["default"](t,e);return s},$.skeduler=a["default"]},{"./skeduler":5}],2:[function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(s,"__esModule",{value:!0});var n=e("./skeduler"),a=i(n),r=e("./adapter");i(r);s["default"]=a["default"],t.exports=s["default"]},{"./adapter":1,"./skeduler":5}],3:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("../template"),n=function(e){return $("<div></div>").addClass(e)},a=function(e){var t=n(e.itemsOptions.itemCardCssClass),s=e.itemsOptions.items,a=(0,i.compileTemplate)(e.itemsOptions.itemCardTemplate,{time:function(e){return e.interval?e.interval.start+" to "+e.interval.end:""}});return s.map(function(e,s){return t.clone().data("index",s).html(a(e))})},r=function(e){var t=$(e.itemsOptions.containerSelector).empty().addClass(e.itemsOptions.itemsCssClass),s=$(t[0].ownerDocument),i=$("."+e.workingIntervalPlaceholderCssClass+" > div"),r=(n().html('<h1 class="si-header">'+e.itemsOptions.title+"</h1>").appendTo(t),n("si-container")),o=a(e);o.forEach(function(e){r.append(e)}),r.appendTo(t);var l=null,d=function c(t){if(null!=l){var i=l,n=i.$movingCard,a=i.$card,r=$("."+e.itemsOptions.highlightItemCss+":visible");if(0!==r.length&&1==r.data("match")){var o=e.lineHeight+1,d=parseInt(n.data("index")),p=e.itemsOptions.items[d],f=60/e.rowsPerHour*(n[0].offsetTop/o),m=e.data[r.parent().data("column")].workingTimeIntervals[r.parent().data("item-index")];e.itemsOptions.onItemWillBeAssigned&&e.itemsOptions.onItemWillBeAssigned({item:p,interval:m,offsetInMinutes:f}),n.detach().css({top:r[0].offsetTop,left:0}).height(r[0].clientHeight).width("auto").removeClass(e.itemsOptions.itemCardCssClass+"-moving").addClass(e.itemsOptions.itemCardCssClass+"-pinned").appendTo(r.parent()),n.on("mousedown",h)}else n.remove(),a.show();$("."+e.itemsOptions.highlightItemCss).hide(),l=null,s.off("mousemove",u),s.off("mouseup",c)}},u=function(t){if(null!=l){var n=l,a=n.$movingCard,r=n.offsetX,o=n.offsetY,d=t.pageX-r,u=t.pageY-o;a.css({top:u+"px",left:d+"px"});var h=s[0].defaultView,c=t.pageX,p=t.pageY-h.scrollY,f=e.lineHeight+1,m=e.rowsPerHour,C=parseInt(a.data("index")),g=e.itemsOptions.items[C],v=g.duration,k=v*(f*m/60);i.each(function(){var t=$(this),s=this.getBoundingClientRect(),i=t.find("."+e.itemsOptions.highlightItemCss);if(c>s.left&&c<s.right&&p>s.top&&p<s.bottom){var n=p-s.top,a=Math.floor(n/f)-1,r=Math.min(Math.max(0,a*f),this.clientHeight-k),o=60/e.rowsPerHour*(r/f),l=e.data[t.data("column")].workingTimeIntervals[t.data("item-index")],d=e.itemsOptions.matchFunc(g,l,o);i.css({top:r}).css("background-color",d.color).height(k).show(),i.data("match",+d.match)}else i.data("match",0),i.hide()})}},h=function(t){if(1===t.which){var i=$("."+e.skedulerWrapperCssClass),n=$(t.currentTarget),a=n.clone().data("index",n.data("index")).addClass(e.itemsOptions.itemCardCssClass+"-moving").removeClass(e.itemsOptions.itemCardCssClass+"-pinned").width(n.width()).appendTo(i),r=t.pageX-t.offsetX,o=t.pageY-t.offsetY;a.css({top:o+"px",left:r+"px"}),l={$card:n,$movingCard:a,offsetX:t.offsetX,offsetY:t.offsetY},n.hide(),s.on("mousemove",u),s.on("mouseup",d),t.preventDefault()}};t.find("."+e.itemsOptions.itemCardCssClass).on("mousedown",h)};s["default"]=r,t.exports=s["default"]},{"../template":6}],4:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i={headers:null,tasks:[],notAllocatedLabel:"Not allocated",cardTemplate:"<div>${id}</div>",onClick:function(e,t){},skedulerWrapperCssClass:"skeduler-wrapper",containerCssClass:"skeduler-container",headerContainerCssClass:"skeduler-headers",schedulerContainerCssClass:"skeduler-main",taskPlaceholderCssClass:"skeduler-task-placeholder",workingIntervalPlaceholderCssClass:"skeduler-interval-placeholder",cellCssClass:"skeduler-cell",resizableHandlerCssClass:"resizable-handler",resizableSliderCssClass:"resizable-slider",lineHeight:30,borderWidth:1,columnWidth:200,minColumnWidth:100,rowsPerHour:2,columnResizeEnabled:!0,debug:!0,itemsOptions:{enabled:!1,itemsCssClass:"skeduler-items",highlightItemCss:"si-highlight-item",containerSelector:"#skeduler-items",itemCardCssClass:"si-card",itemCardTemplate:"<div>${duration}</div>",items:[],title:"Items",matchFunc:function(){return{match:!0}}}};s.defaultSettings=i},{}],5:[function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(s,"__esModule",{value:!0});var a=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),r=e("./settings"),o=e("./items"),l=i(o),d=e("./template"),u=function(){function e(t,s){n(this,e),this.settings=$.extend(!0,r.defaultSettings,s),this.$container=t,this.$ownerDocument=$(t[0].ownerDocument),this.$headerContainer=null,this.$scheduleEl=null,this.operation=null,this.resizeAllColumns=!0,this.settings.debug&&console.time("skeduler"),this.refresh(),this.settings.debug&&console.timeEnd("skeduler")}return a(e,[{key:"setRowsPerHour",value:function(e){this.settings.rowsPerHour=e,this.refresh()}},{key:"setResizeAllColumns",value:function(e){this.resizeAllColumns=e}},{key:"refresh",value:function(){this.populate(),this.settings.itemsOptions.enabled&&(0,l["default"])(this.settings)}},{key:"populate",value:function(){var e=this;this.$container.empty(),this.$container.addClass(this.settings.containerCssClass);var t=this.settings.headers?this.settings.headers:this.settings.data.map(this.settings.getHeader),s=$("<div></div>");this.$headerContainer=s.clone().addClass(this.settings.headerContainerCssClass),t.forEach(function(t){s.clone().text(t).appendTo(e.$headerContainer)},this),this.$container.append(this.$headerContainer),this.$scheduleEl=s.clone().addClass(this.settings.schedulerContainerCssClass);for(var i=s.clone().addClass(this.settings.schedulerContainerCssClass+"-timeline"),n=s.clone().addClass(this.settings.schedulerContainerCssClass+"-body"),a=s.clone(),r=0;r<24;r++)for(var o=0;o<this.settings.rowsPerHour;o++){var l=s.clone().height(this.settings.lineHeight).addClass(o==this.settings.rowsPerHour-1?"last":"");0==o&&(l=l.css("line-height",this.settings.lineHeight+"px").text(0==o?this.toTimeString(r):"")),l.appendTo(i),s.clone().addClass(this.settings.cellCssClass).height(this.settings.lineHeight).addClass(o==this.settings.rowsPerHour-1?"last":"").appendTo(a)}for(var d=function(t){var i=a.clone(),r=s.clone().addClass(e.settings.taskPlaceholderCssClass);e.appendTasks(r,e.settings.tasks.filter(function(e){return e.column==t}));var o=s.clone().addClass(e.settings.workingIntervalPlaceholderCssClass),l=e.settings.data[t].workingTimeIntervals;e.appendAvailableInterval(o,l,t),i.prepend(r),i.prepend(o),i.appendTo(n),e.updateColumnWidth(t,e.settings.columnWidth)},o=0;o<t.length;o++)d(o);this.$scheduleEl.append(i),this.$scheduleEl.append(n),this.$container.append(this.$scheduleEl);for(var o=0;o<t.length;o++)this.updateColumnWidth(o,this.settings.columnWidth);this.settings.columnResizeEnabled&&this.configureResizing()}},{key:"configureResizing",value:function(){var e=this,t=$("<div></div>"),s=t.clone().addClass(this.settings.resizableHandlerCssClass);this.$container.prepend(s),s.width(this.$container.width());var i=this.$scheduleEl.height()+this.$headerContainer.height(),n=0;this.$headerContainer.find("div").each(function(a,r){t.clone().addClass(e.settings.resizableSliderCssClass).css("left",r.offsetLeft+r.clientWidth).height(i).data("column-id",n++).appendTo(s)}),s.on("mousedown","."+this.settings.resizableSliderCssClass,this.onPointerDown.bind(this))}},{key:"toTimeString",value:function(e){return(e<10?"0":"")+Math.ceil(e)+(Math.ceil(e)>Math.floor(e)?":30":":00")}},{key:"getCardHeight",value:function(e){var t=60*e,s=(this.settings.lineHeight+this.settings.borderWidth)*this.settings.rowsPerHour/60;return Math.ceil(t*s)}},{key:"getCardTopPosition",value:function(e){var t=this.parseTime(e);return(this.settings.lineHeight+this.settings.borderWidth)*(t*this.settings.rowsPerHour)}},{key:"parseTime",value:function(e){return/\d{1,2}\:\d{2}/.test(e)?parseInt(e.split(":")[0])+parseInt(e.split(":")[1])/60:parseInt(e)}},{key:"renderInnerCardContent",value:function(e){var t=this.settings.cardTemplate,s=(0,d.compileTemplate)(t)(e);return $(s)}},{key:"appendTasks",value:function(e,t){var s=this;t.forEach(function(t){var i=s.renderInnerCardContent(t),n=s.getCardTopPosition(t.startTime),a=s.getCardHeight(t.duration),r=$("<div></div>").attr({style:"top: "+n+"px; height: "+a+"px",title:s.toTimeString(t.startTime)+" - "+s.toTimeString(t.startTime+t.duration)});r.on("click",function(e){s.settings.onClick&&s.settings.onClick(e,t)}),r.append(i).appendTo(e)},this)}},{key:"appendAvailableInterval",value:function(e,t,s){var i=this,n=$("<div></div>");t.forEach(function(t,a){var r=n.clone().text(i.settings.notAllocatedLabel),o=i.getCardTopPosition(t.start)+2;console.log("top for start: ",o,t.start);var l=i.parseTime(t.end)-i.parseTime(t.start),d=i.getCardHeight(l)-5,u=n.clone().addClass("si-highlight-item").hide(),h=n.clone().attr({style:"top: "+o+"px; height: "+d+"px"});h.data("column",s).data("item-index",a).append(r).append(u).appendTo(e)},this)}},{key:"onPointerUp",value:function(e){this.operation;this.operation&&(this.$ownerDocument.off("mouseup"),this.$ownerDocument.off("mousemove"),this.operation=null)}},{key:"onPointerMove",value:function(e){var t=this.operation;if(this.operation){var s=e.pageX-t.startX;if(0!==s){var i=t.columnNumber,n=t.width+s;if(this.resizeAllColumns)for(var a=0;a<this.settings.data.length;a++)this.updateColumnWidth(a,n.toFixed(2));else this.updateColumnWidth(i,n.toFixed(2))}}}},{key:"onPointerDown",value:function(e){if(1===e.which){this.operation&&this.onPointerUp(e);var t=$(e.currentTarget),s=t.data("column-id"),i=t.index(),n=this.$headerContainer.find("div").eq(i),a=n[0].clientWidth;this.operation={columnNumber:s,startX:e.pageX,width:a},this.$ownerDocument.on("mousemove",this.onPointerMove.bind(this)),this.$ownerDocument.on("mouseup",this.onPointerUp.bind(this)),e.preventDefault()}}},{key:"updateColumnWidth",value:function(e,t){t=Math.max(t,this.settings.minColumnWidth),$("."+this.settings.headerContainerCssClass+" > div:eq("+e+")").css("flex-basis",t+"px");var s=$("."+this.settings.schedulerContainerCssClass+"-body > div:eq("+e+") > ."+this.settings.cellCssClass),i=s.width()-t;s.width(t),$("."+this.settings.resizableHandlerCssClass+" > div").each(function(t,s){if(t>=e){var n=$(s),a=parseInt(n.css("left").replace("px",""));n.css("left",a-i)}})}}]),e}();s["default"]=u,t.exports=s["default"]},{"./items":3,"./settings":4,"./template":6}],6:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=function(e,t){return function(s){for(var i=e,n=/\$\{(\w+)\}/g,a=/\$\{(\w+)\(\)\}/g,r=1;;){if(r=n.exec(e),!r)break;var o=r[1];s.hasOwnProperty(o)&&(i=i.replace(r[0],s[o]))}for(;t&&(r=a.exec(e));){var o=r[1];t.hasOwnProperty(o)&&(i=i.replace(r[0],t[o](s)))}return i}};s["default"]={compileTemplate:i},t.exports=s["default"]},{}]},{},[2]);
//# sourceMappingURL=jquery.skeduler.min.js.map
